---
title: "How Anxiety/Depression Levels Differed Between States and Regions Following COVID-19"
date: last-modified
author: "Ian Walsh & Logan Rosell"
format: 
    html:
        embed-resources: true
jupyter: python3
---

```{python}
#| echo: false
#| include: false
# Load libraries
import numpy as np
import pandas as pd
import matplotlib.pyplot as plt
import seaborn as sns
import plotly.express as px
from scipy.stats import pearsonr
from sklearn.linear_model import LinearRegression
from sklearn.metrics import PredictionErrorDisplay
from scipy.stats import probplot
from statsmodels.stats.outliers_influence import variance_inflation_factor
import datetime

# Import datasets
state_data = pd.read_csv("state_data.csv")
state_data_wide = pd.read_csv("state_data_wide.csv")
# Reforming to date-time because CSV does not retain formatting
state_data['Time Period Start Date'] = pd.to_datetime(state_data['Time Period Start Date']).dt.date
state_data['Time Period End Date'] = pd.to_datetime(state_data['Time Period End Date']).dt.date

```

# Introduction - Ian

Shortly following the outbreak of COVID-19 in the United States, the CDC began to measure rates of self-reported symptoms of anxiety and depression in the United States from a survey that they sent out. They did this in part because "The spread of disease and increase in deaths during large outbreaks of transmissible diseases is often associated with fear and grief" (Vahratian, et al.). Rates of anxiety and depression symptoms were then estimated for various demographic and geographic groups to see how they changed throughout the course of the pandemic and in the aftermath, from 4/23/2020 to 9/20/2023. In this paper we will explore how rates of anxiety and depression changed during this time period. More specifically though, Our research question is: how did anxiety and depression levels differ between states and regions following the outbreak of COVID-19 in the United States? Our null hypothesis is thus that there was no difference between rates of depression and anxiety in different regions following COVID19, and our alternative hypothesis is that there *were* differences.

We were led to look at regional differences because there are a couple of factors that could make anxiety and depression affect regions differently. For example, different parts of the United States have different demographic and cultural populations which may be more or less susceptible to mental health challenges during a crisis. One article describes how "many cultural and societal norms and beliefs impact the diagnosis and treatment of people with mental health conditions. Stigma, discrimination, racism, and stereotyping all negatively impact mental health and treatment outcomes" (Carr).


# Background - Logan


Anxiety and Depression was measured as a percentage of population exhibiting symptoms using a Patient Health Questionaire survey (Vahratian, Anjel). Surveys were sent via email very two weeks from 4/23/2020 to 9/20/2023. Four questions were included in the survey. During the past 7 days, respondents had been bothered by:
1. Feeling nervous, anxious, or on edge?
2. Not being able to stop or control worrying?
3. Having little interest or pleasure in doing things?
4. Feeling down, depressed, or hopeless?
If a respondent answered yes to either of the first two questions for more than half of the previous 7 days they were included in the population of people exhibiting symptoms of anxiety. Likewise if an individual answered yes to either of the last two questions for more than half of the previous 7 days they were included in the population exhibiting symptoms of depression. This paper's analysis focuses primarily on the combined anxiety and depression rate which an individual would be included in by answering yes to any of the four survey questions for more than half of the previous 7 days. 

Focusing on regions within the United States simultenously allows us to narrow the scope of this analysis to 4 rather than 50 disinct subgroups and allows us to investigate a proxy for cultural and policy variation--geographic differences' impact on symptom rates over time. Research suggests that an individual's political affiliation and socio-economic status influence their COVID-19 outcomes (Lurie, Nicole, and Joshua M Sharfstein). Region is associated with both political affiliation and income, thus we hypothesize it may serve as a predictor of a person's overall COVID-19 experience. Consequently, this regional difference in COVID-19 experience may predict the individual's propensity to display symptoms of anxiety and depression as the pandemic progressed.



# Methods - Logan 

During data cleaning we included regions sorted by US Census Definition ("Census Regions") which breaks the United States into the South, West, Northeast, and Midwest. The data provided by the CDC included observations grouped by age, sex, ethnicity, education, state, disability status, gender identity, and sexual orientation, however only state level observations were preserved in our final dataset due to the focus of this project on regional differences. 

To analyze tends between major national events over the course of our dataset we will be graphing anxiety and depression scores over time and visually comparing movements in the data relative to those key points. 
We have selected 6 key events based on the political and social impact (judged by the authors) to the entire United States. This list is far from 

To gauge the relationship between anxiety and depression rates over time we will be performing a simple linear regression of the combined score as predicted by time period. 

# Results - Both

## Line Graph - Logan
```{python}
#| echo: false
format = '%b %d %Y'
federal_election = datetime.datetime.strptime('Nov 3 2020', format)
floyd_protests = datetime.datetime.strptime('May 25 2020', format)
covid_vaccine = datetime.datetime.strptime('Dec 11 2020', format)
roe_v_wade_overturned = datetime.datetime.strptime('Jun 24 2022', format)
us_mid_terms = datetime.datetime.strptime('Nov 8 2022', format)
covid_over = datetime.datetime.strptime('May 11 2023', format)
national_avgs = state_data.groupby(['Time Period Start Date', 'Indicator'], observed=False).agg(
    nat_means = ('Percent of Population', 'mean')
)
nat_avg_plt = sns.lineplot(national_avgs,
                            x='Time Period Start Date',
                            y='nat_means',
                            hue = 'Indicator')
plt.axvline(floyd_protests,
    color='purple',
    label='George Floyd Protests',
    linestyle='--',)
plt.axvline(federal_election,
    color='red',
    label='Federal Election',
    linestyle='-.',)
plt.axvline(covid_vaccine,
    color='black',
    label='Covid-19 Vaccine Approved',
    linestyle=':',)
plt.axvline(roe_v_wade_overturned,
    color='blue',
    label='Roe V. Wade is Overturned',
    linestyle='--',)
plt.axvline(us_mid_terms,
    color='#06754cff',
    label='Midterm Elections',
    linestyle='-.',)
plt.axvline(covid_over,
    color='orange',
    label='Covid-19 Public Health Emergency Over',
    linestyle=':',)
plt.xticks(rotation=45)
plt.title(r"$\mathbf{Figure\ 1}$: Percent of Pop with Anxiety or Depression Over Time with Major Events Included")
plt.ylabel('Percent of Population')
plt.legend(title='Key',
    loc='right',
    bbox_to_anchor=(1.9, 0.5))

fig = nat_avg_plt.get_figure()

plt.show()
```




```{python}
#| echo: false
#| include: false
format = '%b %d %Y'
peak_1 = datetime.datetime.strptime('Nov 3 2020', format)
trough = datetime.datetime.strptime('May 26 2021', format)
peak_2 = datetime.datetime.strptime('Sep 14 2022', format)
national_avgs = state_data.groupby(['Time Period Start Date', 'Indicator'], observed=False).agg(
    nat_means = ('Percent of Population', 'mean')
)
nat_avg_plt = sns.lineplot(national_avgs,
                            x='Time Period Start Date',
                            y='nat_means',
                            hue = 'Indicator')
nat_avg_plt.lines[0].set_linestyle("-")
nat_avg_plt.lines[1].set_linestyle("-")
nat_avg_plt.lines[2].set_linestyle("-")
plt.axvline(peak_1,
    color='black',
    label='Peak One',
    linestyle=':',)
plt.axvline(trough,
    color='black',
    label='Trough',
    linestyle=':',)
plt.axvline(peak_2,
    color='black',
    label='Peak Two',
    linestyle=':',)
plt.xticks(rotation=45)
plt.title("Percent of Pop with Anxiety or Depression Over Time ")
plt.ylabel('Percent of Population')
plt.legend(title='Key',
    loc='right',
    bbox_to_anchor=(1.9, 0.5))
plt.show()
```

## Map Graph - Logan
```{python}
#| echo: false
min = state_data['Percent of Population'].min()
max = state_data['Percent of Population'].max()

fig = px.choropleth(
    state_data,
    locations='State Code',
    locationmode='USA-states',
    color='Percent of Population',
    facet_row='Symptoms Of',
    scope='usa',
    title= "<b>Figure 2</b>: Map of Anxiety and Depression in US States Over Time",
    hover_name='State',
    color_continuous_scale='amp',
    animation_frame='Time Period Start Date',
    range_color=[min,max],
    height = 700
)

fig.show()
```

## Regional Differences Line Plot

```{python}
#| echo: false
regional_diff = sns.lineplot(state_data[state_data["Indicator"] == "Symptoms of Anxiety Disorder or Depressive Disorder"],
    x="Time Period Start Date",
    y="Percent of Population",
    hue="Region",
    errorbar=None)
regional_diff.set(title=r"$\mathbf{Figure\ 3}$: Combined Symptoms Over Time by Region")
plt.xticks(rotation=45)
plt.show()
```

## Regression - Ian

```{python}
#| echo: false
x_data = state_data_wide[['Time Period',
        'Region_South',
        'Region_West',
        'Region_Northeast']]
y_data = state_data_wide[['Perc of Pop with Symptoms of Either']]



symptoms_over_time_by_region = LinearRegression().fit(x_data,y_data)
score = symptoms_over_time_by_region.score(x_data, y_data)
predict = symptoms_over_time_by_region.predict(x_data)

print('Model Intercept:', round(symptoms_over_time_by_region.intercept_[0], 3))
print('\nModel Coefficients: ')
for name, coef in zip(x_data.columns, symptoms_over_time_by_region.coef_.flatten()):
    print(f'{name} = {coef:.3f}')
print('\nR-Squared: ', round(symptoms_over_time_by_region.score(x_data, y_data), 3))
```

```{python}
#| echo: false
linear_plot = sns.lmplot(state_data_wide,
    x='Time Period',
    y='Perc of Pop with Symptoms of Either',
    col= "Region",
    col_wrap = 2,
    line_kws={'color': 'red'})

fig = linear_plot.fig

fig.suptitle(r"$\mathbf{Figure\ 4}$: Regression of percent of symptoms of depression or anxiety over time, by region", fontsize=14)

plt.tight_layout()
plt.show()
```

### Checks for LINE

```{python}
#| echo: false
display = PredictionErrorDisplay(y_true = y_data, y_pred = predict)
display.plot()
plt.title(r"$\mathbf{Figure\ 5}$: Residuals Plot of Linear Regression Model")
plt.show()

# Does not meet criteria for linearity or equal variance (L, E)
```

```{python}
#| echo: false
residuals = y_data - predict
residuals = np.ravel(residuals)

probplot(residuals, dist = 'norm', plot = plt)
plt.title(r"$\mathbf{Figure\ 6}$: QQ Plot of Linear Regression Model")
plt.show()

# Data looks fairly normally distributed (N)
```

```{python}
#| echo: false
X = state_data_wide[['Time Period',
    'Region_South',
    'Region_West',
    'Region_Northeast']].copy()

X = X.astype(float)

X.insert(0, 'const', 1.0)

X_array = X.values

for i, col in enumerate(X.columns):
    if i == 0:
        continue
    vif = variance_inflation_factor(X_array, exog_idx=i)
    print(col, "VIF =", round(vif, 3))
``` 

# Conclusion - Ian

# References

1. Carr, Naomi. “Relationship between Culture and Mental Health.” MentalHealth.Com, 14 Sept. 2023, www.mentalhealth.com/library/social-cultural-topics.
1. *Census Regions and Divisions of the United States*, U.S. Census Bureau, www2.census.gov/geo/pdfs/maps-data/maps/reference/us_regdiv.pdf. Accessed 2 Dec. 2025. 
2. “Covid-19 Mortality.” *Centers for Disease Control and Prevention*, 20 Aug. 2025, www.cdc.gov/nchs/state-stats/deaths/covid19.html. 
3. “End of the Federal COVID-19 Public Health Emergency (PHE) Declaration.” *Centers for Disease Control and Prevention*, 12 Sept. 2023, archive.cdc.gov/www_cdc_gov/coronavirus/2019-ncov/your-health/end-of-phe.html. 
4. “George Floyd: Timeline of Black Deaths and Protests.” *BBC News*, BBC, 22 Apr. 2021, www.bbc.com/news/world-us-canada-52905408. 
5. Hayward, Ed. “Covid-19’s Toll on Mental Health.” *Boston College*, Apr. 2021, www.bc.edu/bc-web/bcnews/campus-community/faculty/anxiety-and-stress-spike-during-pandemic.html. 
6. Lurie, Nicole, and Joshua M Sharfstein. “State-to-state differences in US covid-19 outcomes: Searching for explanations.” The Lancet, vol. 401, no. 10385, 22 Apr. 2023, pp. 1314–1315, https://doi.org/10.1016/s0140-6736(23)00726-2. 
7. Park, Alice. “The First Authorized COVID-19 Vaccine in the U.S. Has Arrived.” *Time*, 11 Dec. 2020, time.com/5920134/first-authorized-covid-19-vaccine-us/.
8. Suzuki, Sara et al. “Trajectories of sociopolitical stress during the 2020 United States presidential election season: Associations with psychological well-being, civic action, and social identities.” *Comprehensive psychoneuroendocrinology* vol. 16 100218. 31 Oct. 2023, doi:10.1016/j.cpnec.2023.100218 
9. Taylor, Mia. “Which States with the Most and Fewest Coronavirus Restrictions.” *Cheapism*, 17 Sept. 2020, www.cheapism.com/coronavirus-restrictions/. 
10. Totenberg, Nina, and Sarah McCammon. “Supreme Court Overturns Roe v. Wade, Ending Right to Abortion Upheld for Decades.” *NPR*, 24 June 2022, www.npr.org/2022/06/24/1102305878/supreme-court-abortion-roe-v-wade-decision-overturn. 
11. Vahratian, Anjel, et al. “Symptoms of Anxiety or Depressive Disorder and Use of Mental Health Care among Adults during the COVID-19 Pandemic - United States, August 2020–February 2021.” *Centers for Disease Control and Prevention*, 2 Apr. 2021, www.cdc.gov/mmwr/volumes/70/wr/mm7013e2.htm. 